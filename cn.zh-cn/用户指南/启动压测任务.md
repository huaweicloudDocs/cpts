# 启动压测任务<a name="cpts_01_0016"></a>

测试任务指通过在不同压测点执行一系列测试任务，持续对系统发起压力测试，通过测试获取并分析系统运行的性能数据。

您可以在一个测试工程中添加多个测试任务。事务可以被多个测试任务复用，针对每个事务可以定义多个测试阶段，并对每个阶段分别定义持续时间和并发用户数，模拟流量波峰波谷的复杂场景。

## 前提条件<a name="section1594645884318"></a>

-   已添加事务。
-   确保资源组状态为“运行中”。
-   确保资源组的管理节点上的32001和62000端口在安全组被开启。
-   确保资源组的执行节点和被压测的应用之间网络互通。

## 操作步骤<a name="section18955152717438"></a>

1.  登录CPTS控制台，在左侧导航栏中选择“测试工程“，单击待操作工程后的“编辑测试任务“。
2.  在“测试任务“页签中，单击![](figures/添加事务2.png)，选择需要测试的事务，单击![](figures/icon-save.png)。
3.  选择事务后，在已选的事务下单击![](figures/阶段添加.png)。参照[表1](#table1735493091919)设置添加阶段参数，可根据业务需求添加多个阶段。

    **图 1**  添加节点<a name="fig12918104015197"></a>  
    ![](figures/添加节点.png "添加节点")

    **表 1**  新增任务阶段

    <a name="table1735493091919"></a>
    <table><thead align="left"><tr id="row8350430101920"><th class="cellrowborder" valign="top" width="25%" id="mcps1.2.3.1.1"><p id="p19350193011194"><a name="p19350193011194"></a><a name="p19350193011194"></a>参数</p>
    </th>
    <th class="cellrowborder" valign="top" width="75%" id="mcps1.2.3.1.2"><p id="p153501730141919"><a name="p153501730141919"></a><a name="p153501730141919"></a>参数说明</p>
    </th>
    </tr>
    </thead>
    <tbody><tr id="row7350730181913"><td class="cellrowborder" valign="top" width="25%" headers="mcps1.2.3.1.1 "><p id="p035012306196"><a name="p035012306196"></a><a name="p035012306196"></a>压测模型</p>
    </td>
    <td class="cellrowborder" valign="top" width="75%" headers="mcps1.2.3.1.2 "><p id="p16350173011916"><a name="p16350173011916"></a><a name="p16350173011916"></a>选择压测模型：</p>
    <a name="ul1735093061918"></a><a name="ul1735093061918"></a><ul id="ul1735093061918"><li>自定义</li><li>递增模型</li></ul>
    </td>
    </tr>
    <tr id="row163534307192"><td class="cellrowborder" colspan="2" valign="top" headers="mcps1.2.3.1.1 mcps1.2.3.1.2 "><p id="p1235013071919"><a name="p1235013071919"></a><a name="p1235013071919"></a>当压测模型配置为“自定义”时，需要配置以下参数：</p>
    <div class="note" id="note3350113071913"><a name="note3350113071913"></a><a name="note3350113071913"></a><span class="notetitle"> 说明： </span><div class="notebody"><p id="p735033013195"><a name="p735033013195"></a><a name="p735033013195"></a>一个事务可以有多个自定义阶段。</p>
    </div></div>
    </td>
    </tr>
    <tr id="row133531730101910"><td class="cellrowborder" valign="top" width="25%" headers="mcps1.2.3.1.1 "><p id="p2353153012193"><a name="p2353153012193"></a><a name="p2353153012193"></a>阶段名称</p>
    </td>
    <td class="cellrowborder" valign="top" width="75%" headers="mcps1.2.3.1.2 "><p id="p535333016194"><a name="p535333016194"></a><a name="p535333016194"></a>设置一个符合业务场景的名字，比如首页测试。</p>
    </td>
    </tr>
    <tr id="row135310308191"><td class="cellrowborder" valign="top" width="25%" headers="mcps1.2.3.1.1 "><p id="p103531030131920"><a name="p103531030131920"></a><a name="p103531030131920"></a>持续时间（分钟）</p>
    </td>
    <td class="cellrowborder" valign="top" width="75%" headers="mcps1.2.3.1.2 "><p id="p63537307196"><a name="p63537307196"></a><a name="p63537307196"></a>本阶段压测执行的最长时间。</p>
    </td>
    </tr>
    <tr id="row20353173041918"><td class="cellrowborder" valign="top" width="25%" headers="mcps1.2.3.1.1 "><p id="p535323017190"><a name="p535323017190"></a><a name="p535323017190"></a>并发用户（个）</p>
    </td>
    <td class="cellrowborder" valign="top" width="75%" headers="mcps1.2.3.1.2 "><p id="p183533301199"><a name="p183533301199"></a><a name="p183533301199"></a>并发用户数指在同一时刻内，对系统进行业务操作的用户数量，在云性能测试服务中为用户在定义测试任务阶段设置的虚拟用户数。</p>
    </td>
    </tr>
    <tr id="row20353123017191"><td class="cellrowborder" colspan="2" valign="top" headers="mcps1.2.3.1.1 mcps1.2.3.1.2 "><p id="p1335311302195"><a name="p1335311302195"></a><a name="p1335311302195"></a>当压测模型配置为“递增模型”时，需要配置以下参数：</p>
    <div class="note" id="note1335323081919"><a name="note1335323081919"></a><a name="note1335323081919"></a><span class="notetitle"> 说明： </span><div class="notebody"><p id="p1935303091912"><a name="p1935303091912"></a><a name="p1935303091912"></a>一个事务只能有一个梯度递增阶段。</p>
    </div></div>
    </td>
    </tr>
    <tr id="row0353103081919"><td class="cellrowborder" valign="top" width="25%" headers="mcps1.2.3.1.1 "><p id="p1035333061915"><a name="p1035333061915"></a><a name="p1035333061915"></a>梯度阶段名称</p>
    </td>
    <td class="cellrowborder" valign="top" width="75%" headers="mcps1.2.3.1.2 "><p id="p5353103061919"><a name="p5353103061919"></a><a name="p5353103061919"></a>设置一个符合业务场景的名字，比如首页测试。</p>
    </td>
    </tr>
    <tr id="row1035363091913"><td class="cellrowborder" valign="top" width="25%" headers="mcps1.2.3.1.1 "><p id="p13353430141919"><a name="p13353430141919"></a><a name="p13353430141919"></a>总并发用户(个)</p>
    </td>
    <td class="cellrowborder" valign="top" width="75%" headers="mcps1.2.3.1.2 "><p id="p11353330151911"><a name="p11353330151911"></a><a name="p11353330151911"></a>并发用户数指在同一时刻内，对系统进行业务操作的用户数量，在云性能测试服务中为用户在定义测试任务阶段设置的虚拟用户总数。</p>
    </td>
    </tr>
    <tr id="row135463011199"><td class="cellrowborder" valign="top" width="25%" headers="mcps1.2.3.1.1 "><p id="p123531430121919"><a name="p123531430121919"></a><a name="p123531430121919"></a>递增量级</p>
    </td>
    <td class="cellrowborder" valign="top" width="75%" headers="mcps1.2.3.1.2 "><p id="p1935318304197"><a name="p1935318304197"></a><a name="p1935318304197"></a>选择合适的递增量级：</p>
    <p id="p7353203071917"><a name="p7353203071917"></a><a name="p7353203071917"></a>5%</p>
    <p id="p19354143001920"><a name="p19354143001920"></a><a name="p19354143001920"></a>10%</p>
    <p id="p8354193091919"><a name="p8354193091919"></a><a name="p8354193091919"></a>20%</p>
    <p id="p535410308195"><a name="p535410308195"></a><a name="p535410308195"></a>50%</p>
    </td>
    </tr>
    <tr id="row16354103017195"><td class="cellrowborder" valign="top" width="25%" headers="mcps1.2.3.1.1 "><p id="p1735420302196"><a name="p1735420302196"></a><a name="p1735420302196"></a>单量持续时间(分钟)</p>
    </td>
    <td class="cellrowborder" valign="top" width="75%" headers="mcps1.2.3.1.2 "><p id="p1235417305197"><a name="p1235417305197"></a><a name="p1235417305197"></a>本阶段单量压测执行的最长时间。</p>
    </td>
    </tr>
    </tbody>
    </table>

4.  配置完成后，单击“确定“。单击任务后的![](figures/icon-start.png)。
5.  在“启动测试任务”对话框中，选择“资源组”，如[图2](#fig47991765519)所示。

    **图 2**  选择资源组类型<a name="fig47991765519"></a>  
    ![](figures/选择资源组类型.png "选择资源组类型")

    -   共享资源组：基于CCE的放置在CPTS的内置租户下的共享资源组，共享资源组不支持内网ELB。
    -   虚拟资源组：本机创建的虚拟机资源组。
    -   实例化资源组：基于CCI的实例化资源组。

6.  单击“启动”，启动测试任务。
7.  （可选）单击“查看报告”，您可以查看实时测试报告。

## 测试任务填写建议<a name="section1498573263514"></a>

持续时间建议至少300s，并发用户数请根据被压测应用的实际情况填写。通过多次调整压测数据进行反复测试，得到应用所能承受的最大值，进行持续优化和验证。

